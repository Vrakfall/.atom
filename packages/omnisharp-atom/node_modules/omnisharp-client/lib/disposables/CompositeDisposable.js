"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.CompositeDisposable = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _Disposable = require("./Disposable");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var CompositeDisposable = exports.CompositeDisposable = function () {
    function CompositeDisposable() {
        var _this = this;

        _classCallCheck(this, CompositeDisposable);

        this._disposables = new Set();
        this._isDisposed = false;

        for (var _len = arguments.length, disposables = Array(_len), _key = 0; _key < _len; _key++) {
            disposables[_key] = arguments[_key];
        }

        disposables.forEach(function (item) {
            return _this._disposables.add(item);
        });
    }

    _createClass(CompositeDisposable, [{
        key: "dispose",
        value: function dispose() {
            this._isDisposed = true;
            if (this._disposables.size) {
                this._disposables.forEach(function (disposable) {
                    return _Disposable.Disposable.of(disposable).dispose();
                });
                this._disposables.clear();
            }
        }
    }, {
        key: "add",
        value: function add() {
            var _this2 = this;

            for (var _len2 = arguments.length, disposables = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                disposables[_key2] = arguments[_key2];
            }

            if (this.isDisposed) {
                disposables.forEach(function (item) {
                    return _Disposable.Disposable.of(item).dispose();
                });
            } else {
                disposables.forEach(function (item) {
                    return _this2._disposables.add(item);
                });
            }
        }
    }, {
        key: "remove",
        value: function remove(disposable) {
            return this._disposables.delete(disposable);
        }
    }, {
        key: "isDisposed",
        get: function get() {
            return this._isDisposed;
        }
    }]);

    return CompositeDisposable;
}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kaXNwb3NhYmxlcy9Db21wb3NpdGVEaXNwb3NhYmxlLmpzIiwibGliL2Rpc3Bvc2FibGVzL0NvbXBvc2l0ZURpc3Bvc2FibGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7Ozs7SUNDQTtBQUlJLGFBSkosbUJBSUksR0FBdUQ7Ozs4QkFKM0QscUJBSTJEOztBQUgvQyxhQUFBLFlBQUEsR0FBZSxJQUFJLEdBQUosRUFBZixDQUcrQztBQUYvQyxhQUFBLFdBQUEsR0FBYyxLQUFkLENBRStDOzswQ0FBeEM7O1NBQXdDOztBQUNuRCxvQkFBWSxPQUFaLENBQW9CLFVBQUMsSUFBRDttQkFBZSxNQUFLLFlBQUwsQ0FBa0IsR0FBbEIsQ0FBc0IsSUFBdEI7U0FBZixDQUFwQixDQURtRDtLQUF2RDs7aUJBSko7O2tDQVVrQjtBQUNWLGlCQUFLLFdBQUwsR0FBbUIsSUFBbkIsQ0FEVTtBQUVWLGdCQUFJLEtBQUssWUFBTCxDQUFrQixJQUFsQixFQUF3QjtBQUN4QixxQkFBSyxZQUFMLENBQWtCLE9BQWxCLENBQTBCOzJCQUFjLHVCQUFXLEVBQVgsQ0FBYyxVQUFkLEVBQTBCLE9BQTFCO2lCQUFkLENBQTFCLENBRHdCO0FBRXhCLHFCQUFLLFlBQUwsQ0FBa0IsS0FBbEIsR0FGd0I7YUFBNUI7Ozs7OEJBTWtEOzs7K0NBQXhDOzthQUF3Qzs7QUFDbEQsZ0JBQUksS0FBSyxVQUFMLEVBQWlCO0FBQ2pCLDRCQUFZLE9BQVosQ0FBb0IsVUFBQyxJQUFEOzJCQUFlLHVCQUFXLEVBQVgsQ0FBYyxJQUFkLEVBQW9CLE9BQXBCO2lCQUFmLENBQXBCLENBRGlCO2FBQXJCLE1BRU87QUFDSCw0QkFBWSxPQUFaLENBQW9CLFVBQUMsSUFBRDsyQkFBZSxPQUFLLFlBQUwsQ0FBa0IsR0FBbEIsQ0FBc0IsSUFBdEI7aUJBQWYsQ0FBcEIsQ0FERzthQUZQOzs7OytCQU9VLFlBQXFDO0FBQy9DLG1CQUFPLEtBQUssWUFBTCxDQUFrQixNQUFsQixDQUF5QixVQUF6QixDQUFQLENBRCtDOzs7OzRCQWxCOUI7QUFBSyxtQkFBTyxLQUFLLFdBQUwsQ0FBWjs7OztXQVJ6QiIsImZpbGUiOiJsaWIvZGlzcG9zYWJsZXMvQ29tcG9zaXRlRGlzcG9zYWJsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpc3Bvc2FibGUgfSBmcm9tIFwiLi9EaXNwb3NhYmxlXCI7XG5leHBvcnQgY2xhc3MgQ29tcG9zaXRlRGlzcG9zYWJsZSB7XG4gICAgY29uc3RydWN0b3IoLi4uZGlzcG9zYWJsZXMpIHtcbiAgICAgICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuX2lzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgZGlzcG9zYWJsZXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fZGlzcG9zYWJsZXMuYWRkKGl0ZW0pKTtcbiAgICB9XG4gICAgZ2V0IGlzRGlzcG9zZWQoKSB7IHJldHVybiB0aGlzLl9pc0Rpc3Bvc2VkOyB9XG4gICAgZGlzcG9zZSgpIHtcbiAgICAgICAgdGhpcy5faXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NhYmxlcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLl9kaXNwb3NhYmxlcy5mb3JFYWNoKGRpc3Bvc2FibGUgPT4gRGlzcG9zYWJsZS5vZihkaXNwb3NhYmxlKS5kaXNwb3NlKCkpO1xuICAgICAgICAgICAgdGhpcy5fZGlzcG9zYWJsZXMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGQoLi4uZGlzcG9zYWJsZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgZGlzcG9zYWJsZXMuZm9yRWFjaCgoaXRlbSkgPT4gRGlzcG9zYWJsZS5vZihpdGVtKS5kaXNwb3NlKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGlzcG9zYWJsZXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fZGlzcG9zYWJsZXMuYWRkKGl0ZW0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmUoZGlzcG9zYWJsZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzcG9zYWJsZXMuZGVsZXRlKGRpc3Bvc2FibGUpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7SURpc3Bvc2FibGUsIERpc3Bvc2FibGUsIElEaXNwb3NhYmxlT3JTdWJzY3JpcHRpb259IGZyb20gXCIuL0Rpc3Bvc2FibGVcIjtcbmV4cG9ydCBjbGFzcyBDb21wb3NpdGVEaXNwb3NhYmxlIGltcGxlbWVudHMgSURpc3Bvc2FibGUge1xuICAgIHByaXZhdGUgX2Rpc3Bvc2FibGVzID0gbmV3IFNldDxJRGlzcG9zYWJsZU9yU3Vic2NyaXB0aW9uPigpO1xuICAgIHByaXZhdGUgX2lzRGlzcG9zZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKC4uLmRpc3Bvc2FibGVzOiBJRGlzcG9zYWJsZU9yU3Vic2NyaXB0aW9uW10pIHtcbiAgICAgICAgZGlzcG9zYWJsZXMuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoaXRlbSkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgaXNEaXNwb3NlZCgpIHsgcmV0dXJuIHRoaXMuX2lzRGlzcG9zZWQ7IH1cblxuICAgIHB1YmxpYyBkaXNwb3NlKCkge1xuICAgICAgICB0aGlzLl9pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2FibGVzLnNpemUpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmZvckVhY2goZGlzcG9zYWJsZSA9PiBEaXNwb3NhYmxlLm9mKGRpc3Bvc2FibGUpLmRpc3Bvc2UoKSk7XG4gICAgICAgICAgICB0aGlzLl9kaXNwb3NhYmxlcy5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZCguLi5kaXNwb3NhYmxlczogSURpc3Bvc2FibGVPclN1YnNjcmlwdGlvbltdKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIGRpc3Bvc2FibGVzLmZvckVhY2goKGl0ZW06IGFueSkgPT4gRGlzcG9zYWJsZS5vZihpdGVtKS5kaXNwb3NlKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcG9zYWJsZXMuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoaXRlbSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZShkaXNwb3NhYmxlOiBJRGlzcG9zYWJsZU9yU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NhYmxlcy5kZWxldGUoZGlzcG9zYWJsZSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
